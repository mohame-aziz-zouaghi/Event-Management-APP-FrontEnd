<div class="own-events-container p-4">
  <h2 class="mb-4">My Organized Events</h2>

  <!-- Error / No Events -->
  <div *ngIf="loading" class="alert alert-info">Loading your events...</div>
  <div *ngIf="!loading && userEvents.length === 0" class="alert alert-warning">
    You haven't organized any events yet.
  </div>

  <div class="row g-4">
    <div class="col-md-6 col-lg-4 mb-3" *ngFor="let event of userEvents">
      <div class="event-card shadow-sm p-3 d-flex flex-column h-100">
        <div
          class="event-header mb-2 d-flex justify-content-between align-items-start"
        >
          <h5>{{ event.title }}</h5>
          <small class="text-muted">{{ getTimeAgo(event.createAt) }}</small>
        </div>
        <p class="text-muted mb-1">
          <strong>Location:</strong> {{ event.location }}
        </p>
        <p class="text-muted mb-1">
          <strong>Capacity:</strong> {{ event.capacity }}
        </p>
        <p class="text-muted mb-1">
          <strong>Reservations:</strong> {{ event.reservations?.length || 0 }}
        </p>
        <p class="text-muted mb-1">
          <strong>Status:</strong>
          <span
            [ngClass]="{
              'text-success': getEventStatus(event) === 'Not Started Yet',
              'text-warning': getEventStatus(event) === 'Started',
              'text-danger': getEventStatus(event) === 'Full',
              'text-muted font-italic': getEventStatus(event) === 'Ended'
            }"
          >
            {{
              getEventStatus(event) === "Full"
                ? getFullStatus(event)
                : getEventStatus(event)
            }}
          </span>
        </p>

        <div class="mt-auto d-flex justify-content-between gap-2">
          <button
            class="btn btn-outline-primary btn-sm"
            (click)="openEditEvent(event)"
          >
            <i class="fas fa-edit me-1"></i> Edit
          </button>
          <button
            class="btn btn-outline-danger btn-sm"
            (click)="deleteEvent(event)"
          >
            <i class="fas fa-trash me-1"></i> Delete
          </button>
        </div>
      </div>
    </div>
  </div>

  <!-- Edit Event Modal -->
  <div class="modal-overlay" *ngIf="showEditModal" (click)="closeEditModal()">
    <div class="modal-card p-4" (click)="$event.stopPropagation()">
      <h5>Edit Event</h5>
      <form>
        <div class="mb-2">
          <label>Title</label>
          <input
            type="text"
            class="form-control"
            [(ngModel)]="editEvent.title"
            name="title"
          />
        </div>
        <div class="mb-2">
          <label>Description</label>
          <textarea
            class="form-control"
            [(ngModel)]="editEvent.description"
            name="description"
          ></textarea>
        </div>
        <div class="mb-2">
          <label>Location</label>
          <input
            type="text"
            class="form-control"
            [(ngModel)]="editEvent.location"
            name="location"
          />
        </div>
        <div class="mb-2">
          <label>Capacity</label>
          <input
            type="number"
            class="form-control"
            [(ngModel)]="editEvent.capacity"
            min="5"
            name="capacity"
          />
        </div>
        <div class="mb-2">
          <label>Start Date & Time</label>
          <input
            type="datetime-local"
            class="form-control"
            [(ngModel)]="editEvent.startDate"
            name="startDate"
          />
        </div>
        <div class="mb-2">
          <label>End Date & Time</label>
          <input
            type="datetime-local"
            class="form-control"
            [(ngModel)]="editEvent.endDate"
            name="endDate"
          />
        </div>

        <div class="mt-3 d-flex justify-content-end gap-2">
          <button
            type="button"
            class="btn btn-secondary"
            (click)="closeEditModal()"
          >
            Cancel
          </button>
          <button
            type="button"
            class="btn btn-primary"
            (click)="submitEditEvent()"
          >
            Save
          </button>
        </div>
      </form>
    </div>
  </div>
</div>
